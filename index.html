<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>오늘의 운세</title>
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Brush+Script&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: sans-serif;
      background-color: #ffffff;
      display: flex;
      justify-content: center;
      align-items: start;
      min-height: 100vh;
      margin: 0;
      padding-top: 40px;
    }
    .container {
      width: 95%;
      max-width: 700px;
      padding: 40px;
      border-radius: 12px;
      background-color: #fdfdfd;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
      text-align: center;
    }
    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      font-size: 36px;
      color: black;
      font-family: 'Nanum Brush Script', cursive;
      margin-bottom: 30px;
    }
    .logo .symbol {
      font-size: 52px;
    }
    .input-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }
    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      max-width: 500px;
    }
    .input-group label {
      width: 120px;
      text-align: right;
    }
    .input-group input,
    .input-group select {
      flex: 1;
      padding: 10px;
      font-size: 16px;
    }
    .result {
      display: none;
      margin-top: 30px;
      line-height: 1.7;
    }
    .barnum, .saju {
      font-size: 16px;
      margin-top: 20px;
      text-align: left;
    }
    .fortune {
      font-weight: normal;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      background-color: #fefff8; 
      color: #222;
      font-size: 18px;
      text-align: center;
    }
    .other-title {
      font-weight: bold;
      font-size: 20px;
      color: #222;
      border-bottom: 1px solid #ccc;
      margin-bottom: 8px;
    }
    .fortune-title {
      font-weight: bold;
      font-size: 20px;
      color: #1a7f42;
      border-bottom: 1px solid #ccc;
      margin-bottom: 8px;
      text-align: center;
    }
    .saju-card {
      background-color: #fafafa;
      border-radius: 16px;
      padding: 30px;
      margin-top: 30px;
      box-shadow: 0 0 12px rgba(0,0,0,0.05);
    }
    .saju-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin-top: 15px;
    }
    .saju-box {
      background-color: white;
      border-radius: 10px;
      padding: 10px 0;
      font-weight: bold;
      border: 1px solid #bbb;
      font-size: 20px;
    }
    .saju-elem {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .wood { background-color: #e6f5e6; color: #006400; }
    .fire { background-color: #ffe5e5; color: #b22222; }
    .earth { background-color: #f5efe3; color: #8b4513; }
    .metal { background-color: #f0f0f0; color: #555555; }
    .water { background-color: #e6f0ff; color: #1e90ff; }
    .saju-interpretation {
      margin-top: 30px;
      padding: 20px;
      background-color: #fef6f9;
      border-radius: 10px;
      font-size: 16px;
      color: #333;
      text-align: left;
    }
    button {
      padding: 10px 25px;
      font-size: 16px;
      cursor: pointer;
      font-family: sans-serif;
      border: 1px solid #888;
      background: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <div class="symbol">☯</div>
      <div class="text">오늘의 운세</div>
    </div>
    <div class="input-section" id="input-section">
      <div class="input-group">
        <label for="name">이름:</label>
        <input type="text" id="name">
      </div>
      <div class="input-group">
        <label for="gender">성별:</label>
        <select id="gender">
          <option value="남성">남성</option>
          <option value="여성">여성</option>
        </select>
      </div>
      <div class="input-group">
        <label for="dob">생년월일:</label>
        <input type="date" id="dob">
      </div>
      <div class="input-group">
        <label for="branch">출생시 (지지):</label>
        <select id="branch">
          <option value="0">자시 (子時, 23:00~00:59)</option>
          <option value="1">축시 (丑時, 01:00~02:59)</option>
          <option value="2">인시 (寅時, 03:00~04:59)</option>
          <option value="3">묘시 (卯時, 05:00~06:59)</option>
          <option value="4">진시 (辰時, 07:00~08:59)</option>
          <option value="5">사시 (巳時, 09:00~10:59)</option>
          <option value="6">오시 (午時, 11:00~12:59)</option>
          <option value="7">미시 (未時, 13:00~14:59)</option>
          <option value="8">신시 (申時, 15:00~16:59)</option>
          <option value="9">유시 (酉時, 17:00~18:59)</option>
          <option value="10">술시 (戌時, 19:00~20:59)</option>
          <option value="11">해시 (亥時, 21:00~22:59)</option>
          </select>
      </div>
      <div class="input-group">
        <label></label>
        <label style="display: flex; align-items: center; gap: 5px;">
          <input type="checkbox" id="unknown-hour" onchange="document.getElementById('branch').disabled = this.checked;"> 출생시 모름
        </label>
      </div>
      <button onclick="showResult()">운세 보기</button>
    </div>
    <div class="result" id="result-section">
      <div class="barnum">
        <div class="other-title">사주 총운</div>
        당신은 일상에서 균형을 중시하는 성향을 가지고 있으며, 본인의 페이스를 유지하려는 경향이 있습니다. 사람들과 어울릴 때는 조화로움을 중요시하지만, 때로는 혼자만의 시간이 꼭 필요하다고 느끼기도 합니다. 어떤 일을 시작하기 전 여러 가능성을 염두에 두는 편이며, 맡은 일을 완수하기 위해 최선을 다하는 편입니다.
      </div>
      <div class="fortune">
        <div class="fortune-title">오늘의 운세</div>
        오늘은 주의가 비교적 안정적으로 유지되고,<br>복잡한 정보나 수치를 처리하는 데에도 부담이 적은 하루입니다.<br>머릿속에서 생각이 잘 정리되는 느낌이 들며,<br>의사결정도 비교적 빠르게 이루어질 수 있습니다.<br>논리적으로 사고를 전개하는 문제에서도 자연스럽게 해답에 도달할 수 있습니다.
      </div>
      <div class="saju-card">
        <div style="font-weight: bold; font-size: 18px; margin-bottom: 10px;">사주명식</div>
        <div id="user-info" style="margin-bottom: 10px;"></div>
        <div style="font-size: 14px; color: #444; margin-bottom: 20px;">
          아래는 당신의 천간과 지지로 이루어진 명식입니다. <br> 각 글자 아래에는 오행이 색으로 구분되어 있으며, 이를 통해 당신의 성향과 기운을 알 수 있습니다.
        </div>
        <div class="saju-grid" id="saju-gan"></div>
        <div class="saju-grid" id="saju-ji"></div>
        <div class="saju-interpretation" id="saju-interpretation">
        </div>
    </div>
  </div>
  <script>
    const gan = ["갑", "을", "병", "정", "무", "기", "경", "신", "임", "계"];
    const ji = ["자", "축", "인", "묘", "진", "사", "오", "미", "신", "유", "술", "해"];
    const ganElement = ["wood", "wood", "fire", "fire", "earth", "earth", "metal", "metal", "water", "water"];
    const jiElement = ["water", "earth", "wood", "wood", "earth", "fire", "fire", "earth", "metal", "metal", "earth", "water"];
    const baseYear = 1984;

    function getGanJiIndex(offset, cycle) {
      return offset >= 0 ? offset % cycle : (cycle + (offset % cycle)) % cycle;
    }

    function calcSaju(dateStr, hour, minute) {
      const date = new Date(dateStr);
      const year = date.getFullYear();
      const month = date.getMonth() + 1;
      const day = date.getDate();
      const timeVal = hour + minute / 60;
      const yearOffset = year - baseYear;
      const yearGanIdx = getGanJiIndex(yearOffset, 10);
      const yearJiIdx = getGanJiIndex(yearOffset, 12);
      const monthGanIdx = getGanJiIndex((yearOffset * 12 + month), 10);
      const monthJiIdx = getGanJiIndex(month - 1, 12);
      const dayOffset = Math.floor((date - new Date(baseYear, 0, 1)) / (1000 * 60 * 60 * 24));
      const dayGanIdx = getGanJiIndex(dayOffset, 10);
      const dayJiIdx = getGanJiIndex(dayOffset, 12);
      const timeIndex = Math.floor(timeVal / 2) % 12;
      const timeJiIdx = timeIndex;
      const timeGanIdx = getGanJiIndex(timeIndex, 10);
      return {
        gan: [yearGanIdx, monthGanIdx, dayGanIdx, timeGanIdx],
        ji: [yearJiIdx, monthJiIdx, dayJiIdx, timeJiIdx]
      };
    }

    function elementName(e) {
      switch(e) {
        case "wood": return "木";
        case "fire": return "火";
        case "earth": return "土";
        case "metal": return "金";
        case "water": return "水";
        default: return "";
      }
    }

    function toggleHourInput(checkbox) {
      document.getElementById('hour').disabled = checkbox.checked;
      document.getElementById('minute').disabled = checkbox.checked;
      if (checkbox.checked) {
        document.getElementById('hour').value = "";
        document.getElementById('minute').value = "";
      }
    }


    function interpretSaju(elements) {
      const counts = { wood: 0, fire: 0, earth: 0, metal: 0, water: 0 };
      elements.forEach(e => counts[e]++);

      const sorted = Object.entries(counts).sort((a, b) => b[1] - a[1]);
      const top = sorted[0];
      const bottom = sorted[4];

      const elementLabels = {
        wood: '목(木)', fire: '화(火)', earth: '토(土)', metal: '금(金)', water: '수(水)'
      };

      let interpretation = `당신의 명식에서 가장 두드러지는 오행은 ${elementLabels[top[0]]}입니다.`;

      return interpretation;
    }


    function showResult() {
      const name = document.getElementById('name').value;
      const gender = document.getElementById('gender').value;
      const dob = document.getElementById('dob').value;
      const unknown = document.getElementById('unknown-hour').checked;
      const hour = unknown ? 12 : parseInt(document.getElementById('hour').value);
      const minute = unknown ? 0 : parseInt(document.getElementById('minute').value);
      if (!name || !dob || (!unknown && (isNaN(hour) || isNaN(minute)))) {
        alert("이름, 생년월일, 출생시:분을 모두 입력해주세요.");
        return;
      }
      const saju = calcSaju(dob, hour, minute);
      document.getElementById("input-section").style.display = "none";
      document.getElementById("result-section").style.display = "block";
      document.getElementById("user-info").innerText = `${name} (${gender}, 출생: ${dob} ${unknown ? '시 미상' : hour + '시 ' + minute + '분'})`;
      const ganDiv = document.getElementById("saju-gan");
      const jiDiv = document.getElementById("saju-ji");
      ganDiv.innerHTML = "";
      jiDiv.innerHTML = "";

      const allElements = [];
      saju.gan.forEach(i => {
        allElements.push(ganElement[i]);
        ganDiv.innerHTML += `<div class='saju-box saju-elem ${ganElement[i]}'>${gan[i]}<br>(${elementName(ganElement[i])})</div>`;
      });
      saju.ji.forEach(i => {
        allElements.push(jiElement[i]);
        jiDiv.innerHTML += `<div class='saju-box saju-elem ${jiElement[i]}'>${ji[i]}<br>(${elementName(jiElement[i])})</div>`;
      });

      const interpretation = interpretSaju(allElements);
      document.getElementById("saju-interpretation").innerText = interpretation;
    }
  </script>
</body>
</html>